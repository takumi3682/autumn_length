---
title: "生物季節観測データの相互相関解析"
subtitle: "日本気象予報士会 東北支部　2026年2月例会"
author: "No.3682 岩渕　巧"
date: "2026-02-07"
lang: ja
format: 
  revealjs:
    theme: simple
    slide-number: true
    incremental: false
    embed-resources: false
    css: styles_slide.css
  pdf:
    pdf-engine: lualatex
    documentclass: ltjsarticle
execute: 
  echo: false
  message: false
  warning: false
params:
  city: "仙台"
---

## データ概要

* 元データ: `r params$city` における生物季節観測データ
および 月平均気温から算出した季節平均値

* 「さくら開花」などは年の初め（1月1日）から数えて何日目（Days of Year）
で表現

* spring:3〜5月、summer:6〜8月、autumn:9〜11月、winter:12〜2月　
の平均気温

* 下表は表の抜粋

```{r}
library(dplyr)
library(knitr)
library(here)

src <- here("data", "processed", "df_merged.rds")
df <- readRDS(src)

df_show <- df |>
  mutate(across(spring:winter, ~ round(.x, 1))) |>
  select(年, さくら開花, すすき開花, いちょう黄葉, spring:winter) |>
  head(12)

knitr::kable(
  df_show,
  format = "html",
  align = c("c","r","r","r","r","r","r","r"),
  table.attr = 'style="font-size:14px; width:100%; table-layout:fixed;"'
)

```


----

## 生物季節観測（時系列、仙台）

![](../outputs/phenology_timeseries_2x2.png){width=100%}

----

### 考察

- うめ開花はばらつきが大きい
- さくら開花・満開は共に早まっている
- あじさい開花は遅くなる傾向、すすき開花は明瞭に早まっている
- いちょう、かえで共に黄葉／紅葉、落葉共に早まっている

- 観測項目同士、観測項目と各季節、あるいは各季節間の相関はどうなっているか？

## Spearman検定

* データを順位（runk）に変換してから計算する相関検定
* 2つの変数が単調な関係にあるかどうかを調べる
* 外れ値に強く、正規分布である必要がない
* データ数 $n$、各データペアの順位の差を $d_{i}$　とすると、

$$
\rho = 1 - \frac{6 \sum d_i^2}{n \left( n^2 - 1 \right)}
$$
* Spearmanによる相関係数を先ほどのデータに適用した結果を示す

----

![](../outputs/Heatmap.png){width=120%}

----

### 考察

- 同種・同じ季節の現象は強い正相関
- 春の現象と夏以降の高温は強い負相関
- 秋の現象と夏〜秋の高温は強い正相関

- 生物季節どうしの関係（左上ブロック）
  - 春の生物季節
    - さくら開花〜さくら満開：0.95、うめ開花〜さくら開花：0.27
    - 同一種内（開花→満開）は極めて高相関
    - 異種でも春イベント間は正相関だが、ばらつきはある（うめとさくら）

  - 秋の生物季節
    - いちょう黄葉〜いちょう落葉：0.82、いちょう黄葉〜かえで紅葉：0.78
    - 秋イベントは 春よりも相関が全体に高め　
  - 春 ↔ 秋の生物季節（負相関）
    - さくら開花 〜 いちょう黄葉：−0.53、すすき開花 〜 いちょう黄葉：−0.74
    - 春が早い年ほど、秋は遅れる
    - 季節の引き伸ばし（春の前倒し＋秋の後ろ倒し）を明確に示唆
    - 「夏が長くなっている感覚」と一致

----

- 生物季節 × 季節平均気温（右側ブロック）
  - 春イベント × 気温
    - さくら開花 × spring：−0.79、さくら開花 × summer：−0.33
    - 春が暖かい年ほど DOYが小さい（＝早い）
    - 特に spring 気温が支配的

  - 秋イベント × 気温
    - いちょう黄葉 × autumn：+0.73、いちょう落葉 × autumn：+0.77
    - 秋が暖かいほど 黄葉・落葉が遅れる
    - 秋イベントは autumn 気温に最も敏感

- すすき開花の特徴
  - すすき開花 × summer：−0.58、すすき開花 × autumn：−0.63
  - 夏〜秋が高温な年ほど すすきは早く咲く
  - 単純な「秋イベント」ではないことを示唆

- 季節平均気温どうし（右下）
  - spring–summer：0.44、summer–autumn：0.58、autumn–winter：0.37
  - 季節間には連続性はあるが、完全ではない
  - 各季節を独立変数として扱う妥当性が確認できる

----

- 今後の方針
  - Spearman相関なので
    - 単調関係は捉えているが因果ではない
    - 長期トレンド（温暖化）を含む可能性
    - 長期トレンド除去後の相関を検討する必要
